<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Pixel F1 Racing HTML</title>
    <style>
        body {
            margin: 0;
            background: #222; /* Fundo mais escuro */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            font-family: 'Courier New', Courier, monospace; /* Fonte mais "retro" */
            overflow: hidden;
        }
        canvas {
            background: #444;
            border-left: 15px solid #1a3c1a; /* Grama pixelada escura */
            border-right: 15px solid #1a3c1a;
            /* Efeito de scanline retro */
            background-image: linear-gradient(rgba(0, 0, 0, 0.1) 50%, transparent 50%);
            background-size: 100% 4px;
            box-shadow: 0 0 30px black;
            /* Importante para pixel art não ficar borrado ao escalar */
            image-rendering: pixelated; 
        }
        #uiContainer {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none; /* Clica através do texto */
        }
        #gameOver {
            position: absolute;
            display: none;
            text-align: center;
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border: 4px solid red;
            z-index: 10;
        }
        h1 { margin: 0; color: red; font-size: 40px;}
        h2 { margin: 10px 0; }
    </style>
</head>
<body>

    <div id="uiContainer">
        <h2>Score: <span id="scoreDisplay">0</span></h2>
        <p>Speed: <span id="speedDisplay">1x</span></p>
    </div>

    <div id="gameOver">
        <h1>CRASH!</h1>
        <p>Fim da linha, piloto.</p>
        <p>Pressione <strong>F5</strong> para correr de novo.</p>
    </div>

    <canvas id="gameCanvas" width="400" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        // Garante que as imagens fiquem nítidas (pixeladas)
        ctx.imageSmoothingEnabled = false; 

        const gameOverScreen = document.getElementById('gameOver');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const speedDisplay = document.getElementById('speedDisplay');

        // --- CARREGAMENTO DAS IMAGENS (Data URIs para facilitar o exemplo) ---
        // Jogador (Azul)
        const playerImg = new Image();
        playerImg.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADW7y+UAAAAAXNSR0IArs4c6QAAAEVJREFUOE9jZKAQcEIxAwXgPwwD/0k1hGE0zDAeBcMIApLSWCTFcaQYQhY7sShG1k+y43GkGEayE9FwREn0I8UwYgAAa5YgE+L+k5oAAAAASUVORK5CYII=';
        
        // Inimigo (Vermelho)
        const enemyImg = new Image();
        enemyImg.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADW7y+UAAAAAXNSR0IArs4c6QAAAEVJREFUOE9jZKAQcEIxAwXgPwwD/0k1hGE0zDAeBcMIApLSWCTFcaQYQhY7sShG1k+y43GkGEayE9FwREn0I8UwYgAAa5YgE+L+k5oAAAAASUVORK5CYII=';

        // Variação de cor para o inimigo (filtro CSS simples no canvas depois)
        // Vamos usar um truque simples: desenhar o inimigo com um filtro vermelho por cima.

        // --- VARIÁVEIS DO JOGO ---
        let gameRunning = true;
        let score = 0;
        let baseSpeed = 4;
        let currentSpeed = baseSpeed;
        let roadOffset = 0; // Para animar a pista

        const player = {
            x: 175, y: 500, width: 50, height: 80, dx: 7 // dx é a velocidade lateral
        };

        const keys = { ArrowLeft: false, ArrowRight: false };
        document.addEventListener('keydown', (e) => { if(e.key in keys) keys[e.key] = true; });
        document.addEventListener('keyup', (e) => { if(e.key in keys) keys[e.key] = false; });

        let obstacles = [];

        function spawnObstacle() {
            if (!gameRunning) return;
            const width = 50;
            const x = Math.random() * (canvas.width - width);
            // Obstáculos começam mais acima para dar tempo de reação com velocidade alta
            obstacles.push({ x: x, y: -150, width: width, height: 80 });
            
            // O tempo entre obstáculos diminui ligeiramente conforme a velocidade aumenta
            let spawnRate = 1500 / (currentSpeed / baseSpeed); 
            setTimeout(spawnObstacle, spawnRate + Math.random() * 500);
        }

        function checkCollision(rect1, rect2) {
            // Margem de tolerância para a hitbox não ser tão punitiva (hitbox menor que a imagem)
            const marginX = 5;
            const marginY = 5;
            return (
                rect1.x + marginX < rect2.x + rect2.width - marginX &&
                rect1.x + rect1.width - marginX > rect2.x + marginX &&
                rect1.y + marginY < rect2.y + rect2.height - marginY &&
                rect1.y + rect1.height - marginY > rect2.y + marginY
            );
        }

        function update() {
            if (!gameRunning) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // --- DESENHA A PISTA ---
            // A velocidade da animação da pista aumenta com a velocidade do jogo
            roadOffset += currentSpeed;
            if (roadOffset > 60) roadOffset = 0; // Reseta o loop da faixa

            ctx.fillStyle = "rgba(255,255,255,0.8)";
            for(let i = -1; i < 10; i++) {
                let y = (i * 80) + roadOffset; 
                ctx.fillRect(195, y, 10, 40); // Faixa central
                // Faixas laterais para dar mais sensação de velocidade
                ctx.fillRect(10, y, 5, 40);
                ctx.fillRect(385, y, 5, 40);
            }

            // --- JOGADOR ---
            if (keys.ArrowLeft && player.x > 5) player.x -= player.dx;
            if (keys.ArrowRight && player.x < canvas.width - player.width - 5) player.x += player.dx;

            // Desenha a imagem do jogador em vez do quadrado
            ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);

            // --- OBSTÁCULOS ---
            for (let i = 0; i < obstacles.length; i++) {
                let obs = obstacles[i];
                obs.y += currentSpeed; // Usando a velocidade dinâmica

                // Desenha o inimigo. Truque para mudar a cor da mesma imagem:
                // Desenhamos a imagem, e depois um quadrado vermelho semitransparente por cima
                ctx.drawImage(enemyImg, obs.x, obs.y, obs.width, obs.height);
                ctx.fillStyle = "rgba(200, 0, 0, 0.6)"; // Vermelho transparente
                ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
                

                if (checkCollision(player, obs)) {
                    gameRunning = false;
                    gameOverScreen.style.display = 'block';
                }
            }

            // --- LÓGICA DE PONTUAÇÃO E VELOCIDADE ---
            if (obstacles.length > 0 && obstacles[0].y > canvas.height) {
                obstacles.shift();
                score++;
                scoreDisplay.innerText = score;

                // AUMENTO EXPONENCIAL DE VELOCIDADE
                // Multiplica a velocidade atual por 1.02 (aumento de 2%) a cada carro ultrapassado
                currentSpeed = currentSpeed * 1.02;

                // Limite máximo de velocidade para não quebrar o jogo
                if (currentSpeed > 22) currentSpeed = 22;

                // Atualiza o display de velocidade (arredondando)
                speedDisplay.innerText = (currentSpeed / baseSpeed).toFixed(1) + "x";
            }

            requestAnimationFrame(update);
        }

        // Espera as imagens carregarem antes de começar
        playerImg.onload = () => {
             spawnObstacle();
             update();
        }

    </script>
</body>
</html>